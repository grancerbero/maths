---
output: html_document
---

# Probabilidad

## Espacios muestrales

::: {#muestral .definition name="Espacio muestral y evento"}
El *espacio muestral* $S$ de un experimento es el conjunto de todos los posibles resultados de un experimento. Un *evento* $A$ es un subconjunto del espacio muestral $S$ y se dice que $A$ *ocurrió* si el resultado actual pertenece a $A$
:::

[@blitzstein2019]

```{r echo=FALSE, out.width='30%', fig.cap="Un espacio muestral es como  un mundo de canicas con dos eventos $A$ y $B$", fig.align='center'}

knitr::include_graphics('./images/pebbles.png')
```

El espacio muestral de un experimento puede ser finito o infinito contable o infinito incontable, cuando el espacio muestral es finito puede visualizarse como un mundo de canicas, como muestra la figura. Cada canica representa un resultado, y un evento es un conjunto de canicas. Realizar un experimento es equivalente a escoger una canica en forma aleatoria.

Por ejemplo, sea $S$ el espacio muestral de un experimento y sean $A$ y $B$ eventos. Entonces, la unión $A \cup B$ es el evento que ocurre si y solo si al menos uno de $A$ y $B$ ocurre, la intersección $A \cap B$ es el evento que ocurre si y solo si ambos $A$ y $B$ ocurren, y el complemento $A^c$ es el evento que ocurre si y solo si $A$ no ocurre. También tenemos las leyes de De Morgan:

$$(A \cup B)^c = A^c \cap B^c \textrm{ and } (A \cap B)^c = A^c \cup B^c$$

puesto que decir que no es el caso que al menos uno de $A$ y $B$ ocurra es lo mismo que decir que $A^c$ no ocurre y $B^c$ no ocurre, y decir que no es el caso que ambos ocurran es lo mismo que decir que al menos uno no ocurre. Resultados análogos se mantienen para uniones e intersecciones de más de dos eventos.

En el ejemplo mostrado en la Figura, $A$ es un conjunto de $n$ canicas, $B$ es un conjunto de $m$ canicas, $A \cup B$ consiste en los $n + m$ canicas en $A$ o $B$ (incluyendo el canicas que está en ambos), $A \cap B$ consiste en las canicas que está en ambos $A$ y $B$, y $A^c$ consiste en las $n$ canicas que no están en $A$.

En el ejemplo de la figura, $A$ es un conjunto de 5 canicas,$B$ es un conjunto de 4 canicas, $A \cup B$ es un conjunto de 8 canicas, incluyendo la que esta en los dos conjuntos, $A \cap B$ es un conjunto de 1 canica y $A^c$ consiste en cuatro canicas que no están en $A$

::: {#coins .example name="Espacio muestral y evento"}
Una moneda es lanzada 10 veces , se escribirá heads como $H$ y tails como $T$, un posible resultado es $HHHTHHTTHT$, el espacio muestral es el conjunto de todas las posibles cadenas de longitud 10 de $H's$ y $T's$.

Se puede codificar $H$ como $1$ y $T$ como $0$, asi que un resultado es una secuencia $(s_1,s_2,s_3, ..., s_{10}))$ con $s_j \in \{0, 1\}$, y el espacio muestral es el conjunto de todas esas secuencias.

Veamos ahora algunos eventos:

1.  Sea $A_1$ el evento en que la primer lanzamiento es Head

$$ A_1 = {(1,s_2, ...,s_{10}) }: s_j \in\ \{0,1\} , 2 \leq j  \leq  10$$

Este es un subconjunto del espacio muestral, o sea un evento, decir que $A_1$ ocurre es lo mismo que decir que el primer lanzamiento es Head. Similarmente se dice que $A_j$ es el evento en que el $j_{esimo}$ lanzamiento es Head, donde j =2,3,...,10.

2.  Sea $B$ el evento en el que al menos un lanzamiento fue head $$ B =   \bigcup_{j=1}^{10} A_j  $$

3.  Sea $C$ el evento en el que todos los lanzamientos fueron heads $$ C =   \bigcap_{j=1}^{10} A_j  $$

4.  Sea $D$ el evento en que hubo al menos dos Heads consecutivos

$$ C =   \bigcup_{j=1}^{9} ( A_j \cap A_{j+1} )   $$
:::

## Definicion ingenua de probabilidad (Naive definition of probability)

Históricamente, la definición de probabilidad de un evento fue contar el número de maneras en que evento puede suceder y dividir por el número total de resultados posibles del experimento.

::: {#definicioningenuaprobabilidad .definition name="Definición ingenua de probabilidad"}
Sea $A$ un evento para un experimento con un espacio muestral finito $S$ . la probabilidad ingenua de $A$ es

$$P_{naive} (A) = \frac{|A|}{|S|} = \frac { numero\, de\, resultados\, favorables\, de\, A}{total\, numero\, de\, resultados\, en\, S} $$

en donde $|A|$ es el tamaño (cardinalidad ) del conjunto $A$
:::

La definición ingenua es muy restrictiva en que esto requiere que $S$ sea finito, con igual masa para cada uno de las canicas por ejemplo. A a menudo es mal aplicado por personas que asumen resultados igualmente probables sin justificación y presentan argumentos en el sentido de " o sucederá o no sucederá y no sabemos cual, así que es 50-50". Por ejemplo, si no sabemos si hay vida en saturno ¿deberíamos concluir que es 50-50? ¿Que pasa con la vida inteligente en saturno, que parece que debería ser estrictamente menos probable que exista alguna forma de vida en saturno ? Sin embargo hay varios tipos importantes de problemas en los que la definición ingenua es aplicable, como cuando hay simetría en el problema, que hace que los resultados sean igualmente probables.[@blitzstein2019]

## Probabilidad y conteo

Calcular la probabilidad ingenua de un evento $A$ implica contar el numero de canicas en $A$ y el numero de canicas en el espacio muestral $S$. A menudo estos conjuntos con extremadamente grandes, por lo que podría ser tedioso o inviable contar las posibilidades uno a uno. Para abordar este desafío existen algunas técnicas de conteo.

::: {#reglamultiplicacion .theorem name="Regla de la multiplicación"}
Consideremos un experimento compuesto consistiendo en dos sub-experimentos, experimento $A$ y experimento $B$. supongamos que el experimiento $A$ tiene $a$ posibles resultados y para cada uno de esos resultados el experimento $B$ tiene $b$ posibles resultados, entonces el experimento compuesto tiene $ab$ posibles resultados
:::

Imaginemos un diagrama como muestra la figura, consta de

::: {#ejemplomultiplicacion .example name="conos de helado"}
Supongamos que estamos comprando un helado en cono, se puede escoger entre un cake(pastel) o un waffle(oblea) y cada uno de ellos puede tener chocolate , vainilla o fresa como su sabor
:::

```{r echo=FALSE, out.width='80%', fig.cap="Diagrama de árbol para un cono de helado", fig.align='center'}

knitr::include_graphics('./images/reglademultiplicacion1.drawio.png')
```

Por la regla de la multiplicación existen $2.3=3.2=6$ posibilidades. Pero debemos tener en cuenta algunas cosas como:

-   No importa si se elige primero el tipo de cono ( "quiero un cono de waffles con helado de chocolate" ) o el sabor ("Quiero un cono de chocolate en un cono de waffles"), de cualquier forma hay posibilidades.

-   No importa si los mismos sabores están disponibles en un cono de pastel que en un cono de oblea, Lo que importa es que hay exactamente tres opciones de sabor para cada opción de cono, si por algún motivo estuviese prohibido tener un sabor de chocolate en un cono de oblea por ejemplo ( y sin sustituto, ) , hay posibilidades pero la regla de multiplicación no aplicaría.

Podemos usar la regla de multiplicación para llegar a fórmulas de muestreo con y sin reemplazo. Muchos experimentos en probabilidad y estadística pueden interpretarse en un de estos dos contextos, por lo que es atractivo que ambas fórmulas seigan directamente el mismo principio básico de conteo.

::: {#muestreoconreemplazo .theorem name="Muestreo con reemplazo"}
Consideremos $n$ objetos y tomamos $k$ de ellos, una a la vez con reemplazo( es decir elegir un determinado objeto no impide que se elija nuevamente). entonces hay $n^k$ posibles resultados
:::

Por ejemplo, imaginemos que un frasco con $n$ canicas, etiquetadas del 1 a $n$, tomamos muestras de las bolas, una a la vez con reemplazo, lo que significa que cada vez que se elige una bola, se devuelve al frasco. Cada bola muestreada es un sub-experimento con $n$ posibles resultados, y hay $k$ sub-experimentos, entonces mediante la regla de multiplicación , hay $n^k$ formas de obtener una muestra de tamaño $k$

```{r echo=FALSE, fig.cap="Muestreo con reemplazo cuando n=5 y k = 2", fig.align='center'}

knitr::include_graphics('./images/muestreoconreemplazo.drawio.png')
```

::: {#muestreosinreemplazo .theorem name="Muestreo sin reemplazo"}
Consideremos $n$ objetos y tomamos $k$ de ellos, una a la vez sin reemplazo( es decir elegir un determinado objeto y se impide que se elija nuevamente). entonces hay $n(n-1) ... (n-k+1)$ posibles resultados , para $k <= n$ y (0 posibilidades para $k>n$)
:::

```{r echo=FALSE, fig.cap="Muestreo sin reemplazo cuando n=5 y k = 2", fig.align='center'}

knitr::include_graphics('./images/muestreosinreemplazo.drawio.png')
```

El resultado es consecuencia directa de la regla de multiplicación: cada canica muestreada es otra vez un sub-experimento, y el número de posibles resultados decrece en uno (1) cada vez. Notemos que para muestrear $k$ de $n$ objetos sin reemplazo, necesitamos $k <= n$, mientras que en el muestreo con reemplazo los objetos son inagotables.

::: {#permutaciones .example name="Permutaciones y factoriales"}
Una *permutación* de $1,2,...,n$ es una disposicion de ellos en algun orden, ej. $3,5,1,2,4$ es una permutación de $1,2,3,4,5$ por el teorema \@ref(thm:muestreosinreemplazo) con $k=n$ tendríamos que hay $n!$ permutaciones de $1,2,...,n$. Por ejemplo hay $n!$ maneras en las cuales $n$ personas pueden alinearse en una fila para comprar un helado
:::

Los teoremas \@ref(thm:muestreoconreemplazo) y \@ref(thm:muestreosinreemplazo) se refieren a *conteo*, pero cuando la definición de probabilidad ingenua aplica, podemos usarlos para calcular *probabilidades*

::: {#problemanacimiento .example name="Problema del nacimiento"}
Existen $k$ personas en un cuarto, asumimos que los cumpleaños de cada persona son igualmente probables para cualquiera de los $365$ días del año (se excluye febrero 29), y que los cumpleaños son independientes ( no hay gemelos en el cuarto), cual es la probabilidad que dos o mas personas en el grupo tengan la misma fecha de cumpleaños.
:::

**Solución**
La definición de probabilidad ingenua  dice que solo necesitamos   contar el numero de formas para asignar cumpleaños a $k$ personas de tal forma que  hay dos o mas personas comparten la misma fecha de cumpleaños. Este problema de conteo es un poco complejo, puesto que por ejemplo  Emma y Steve  comparten la fecha de cumpleaños, o Steve  y Naomi o los tres juntos,  o  tres de  ellos  pueden compartir la fecha  de cumpleaños, mientras  otros dos en el grupo comparten fecha de nacimiento diferentes, o un monton de otras posibilidades.

En vez de eso, contemos el complemento: el numero de maneras  para asignar cumpleaños a $k$ personas  de tal forma que no haya dos personas  que compartan un cumpleaños. Esto equivale  a un muestreo de los 365 dias del año _sin_ reemplazo, es decir  para la primera persona, hay $365$ opciones para elegir el día del año de su cumpleaños, para la segunda persona, quedan 364 opciones, ya que no puede compartir el mismo día de cumpleaños con la primera persona. De manera similar, para la tercera persona quedan 363 opciones, puesto que no puede compartir el mismo día de cumpleaños con las dos primeras personas, de igual forma para la $k-esima$ persona hay $365-k+1$ opciones, por lo tanto el numero total de formas de asignar cumpleaños es por el teorema \@ref(thm:muestreosinreemplazo) de $365.364.363...(365-k+1)$ para $k<=365$ 

Sea $A$ el evento de obtener formas en que todas $k$ personas cumplen años en días diferentes, por tanto $|A|=365.364.363...(365-k+1)$ 


El total de formas posibles de asignar cumpleaños en el cuarto es $|S|=365^k$, a las $k$ personas, ya que cada persona puede tener su cumpleaños en cualquiera de los 365 días del año, de acuerdo al teorema \@ref(thm:muestreoconreemplazo)

por tanto :

$$P(A)=\frac{|A|}{|B|} =\frac{365.364.363...(365-k+1)}{365^k}  $$

$$P(A)=\frac{|A|}{|B|} =\frac{365.364.363...(365-k+1)}{365^k}  $$
Por tanto  la probabilidad de que al menos una fecha de cumpleaños coincida es;
$$1 - P(A) = 1- \frac{365.364.363...(365-k+1)}{365^k}  $$
La figura  realizada con python  dibuja la probabilidad  de que  al menos una fecha de cumpleaños  concuerda  como una funcion de $k$. con $k=23$ la probabilidad de coincidencia  excede  $0.5$, para $k=57$ la probabilidad  es cercana al %99%

```{r echo=FALSE, out.width='60%', fig.cap="Probabilidad de  que en un cuarto de $k$ personas al menos dos nacen en el mismo día", fig.align='center'}
knitr::include_graphics('./images/paradojacumpleanos.png')
```
