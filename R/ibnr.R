mpbs <- c(
  171144175142,10519324818,1445080949,342509067,515341272,140966216,268125943,152599957,229793121,94148797,118262541,94587851,27428785,147964946,43066318,51335206,8327568,33438919,4136537,6910922,13006781,16528780,7412799,2807521,762221,367785,1747656,3991672,119700,1641318,492389,0,65200,10000,247809,0,
  162833205900,11348647476,1059654319,744431221,222738609,202859460,85842949,281177807,146389189,150865609,162587546,21955762,56102119,210324385,25512204,45679764,17156972,6828595,2577485,57094615,13473401,12762984,47300,35912542,201448,126655,11973969,228746,3551220,0,0,238850,967659,199136,0,NA,
  174500463105,12217091216,1984554433,562863403,337907831,189886026,279539389,414037978,145019256,78815714,46781495,248735303,86816062,161090328,20420766,41934137,10197439,45994857,22456173,14088441,85644863,5515044,21123565,32907970,5513167,810238,1504962,23648936,0,10461071,728,5978322,2854886,0,NA,NA,
  172842369684,12146229898,1503075361,504734693,169330281,187676825,439030936,297744458,69112415,20215378,170330937,89957931,120326323,23780735,36819416,15402096,20731897,18327529,11418373,54714279,16383666,114823574,0,25489881,11721189,2476695,107612345,0,1514364,0,439660,0,69908,NA,NA,NA,
  169072832660,11941641070,1755101127,769871714,413211048,327691000,113214573,162766791,27018780,115971878,67725117,249433677,39665777,20170546,1983441,9574761,4969319,15230328,26820121,11377925,57731199,7670341,51511707,3471144,8439608,5938194,0,2628516,8406939,2977507,482909,58208,NA,NA,NA,NA,
  171475258351,14363194833,1448855941,484783185,373764670,269212009,270985365,43906292,308065948,136242816,18336130,35368172,47178682,5224241,34702032,29120457,127591843,10011444,44512487,31040136,2392778,7678727,2386166,16770832,34176704,0,92750,0,2376694,4870822,0,NA,NA,NA,NA,NA,
  178777004970,12488774075,1447778942,498251195,489463047,382277053,129820418,308610295,224206684,67539861,121800922,101349285,55600197,8351964,142895407,114214163,19765308,17442705,5494769,488852,1318580,0,2176944,623958,0,1140000,223000,4278556,0,0,NA,NA,NA,NA,NA,NA,
  174565933231,12897982656,1505023368,772575653,489319449,93831399,325685750,153499483,135537938,87196142,75939630,16557308,19511732,31359727,17524346,2985276,14730204,22475414,623283,43263005,252406,2651027,2206565,8812817,2404053,3774401,12920871,968518,1530166,NA,NA,NA,NA,NA,NA,NA,
  178512934400,13074612069,1482296874,516372578,380476645,397292139,247246637,128560872,305831912,62167618,14651351,52395892,113025364,22018599,12545769,7645001,69385822,5486622,5919317,6271166,45685508,11860810,2059000,11611992,1372294,4575887,248251,117293,NA,NA,NA,NA,NA,NA,NA,NA,
  178062795715,13437580662,1303648762,639530525,925160810,237416290,234635568,444144064,191223940,351125099,79138114,32458291,38653255,7439780,43534647,1129512,19365212,3405497,1298739,12097335,4587838,0,1061192,0,879639,3719864,58208,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  171157148631,13431497343,1777487206,1065585963,344512716,245950208,184168029,212284515,363405366,161050084,81172293,42635590,50642493,29296131,14583277,2021111,10464654,9818679,16863765,2370758,0,4650932,831780,6578733,1022795,5725006,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  167405335887,13234995962,2279363248,354186985,332827393,245467703,258124833,145929181,138065158,72420108,79195015,23639936,26694500,7884522,8097806,25366113,8505128,39194158,21396812,16755012,514300,356100,437378,9122960,0,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  182970490067,12664295268,1877581875,484111790,589291110,329314275,487370809,314958327,158968353,172186993,53975002,116500928,125198162,50061017,135345991,24484052,137331145,9181219,2977703,886508,801747,2102512,91891539,772938,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  171448819949,13421643297,1515075404,672801983,378556614,547946707,462867942,87090343,214444023,102506778,64828904,109792170,86421240,27452716,38928300,94553361,11484223,13361750,2148361,2886201,50954264,10033030,1417849,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  183783382076,14084777285,2046563607,870068800,872316603,303490793,285429149,368694955,111459730,285548404,57835892,68464591,51819878,33668018,62015751,9229330,46406548,7441375,11144501,58921593,18074042,1558656,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  175891747904,12649719153,1940659458,871301198,810226614,508448495,729057122,104954067,301971594,64499780,78543209,46819598,104261121,38953880,2853540,63699379,2267525,6209406,66198267,10274426,307328,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  184372810648,13531820526,1622154385,987559728,403929869,841164878,308344380,444005840,94802291,300301552,83354343,42571779,30408593,15594563,52885329,3660878,35431033,6786762,7353234,3822331,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  174364254214,13236302991,2196892009,808438412,868418360,461864997,621608132,94510113,256965075,212227256,60194358,172042098,6250507,22394843,2068215,82934494,14443269,35550385,1866900,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  169687122894,14119930251,1992638413,1201701376,621401928,395136808,84352678,180447455,77359296,69555904,126788261,40763210,84215842,7879509,31413420,15198760,112784356,12727907,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  176829363767,14690619907,2270177364,1014228165,512456136,423942107,262673510,76034337,59415044,153009406,44835338,40162662,19239980,25937578,40443026,191460431,37874963,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  177012284663,13718969244,2479545939,986603126,444673135,632561070,300911485,55416879,182221415,42470341,39161874,34334239,72310704,25028117,151210551,22257451,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  171232501310,13796765313,2370765929,916465116,529216706,357468926,135880684,165098190,66580875,55676342,34722849,135164330,51564152,151339794,35153154,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  171101424430,15018760542,1743276413,906086260,458332055,196823026,100246549,107031131,78432868,31004358,33525393,67951170,155610191,27294422,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  164678553384,13232388905,2093479325,590412339,306769959,106132546,118230598,87487528,200768161,34024715,140103212,189663013,91037420,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  187476899468,12854782849,2511039067,1266663945,419333560,291554741,293283306,251535780,33304354,137586315,663794822,329662195,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  185581131158,12275414898,1838401531,832449462,433054281,299089665,107321167,101246345,274900245,300702563,171261148,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  192652996131,14543897762,1968961888,595802138,362582224,286416660,133508300,325822055,750558820,128486816,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  189227924180,12803691303,1745148776,576937225,391995729,382739431,195670177,512758605,146816863,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  182077332972,14226247017,1906027669,933085544,605592465,184061574,422012341,102625753,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  180655061271,13565138711,1995555461,1062891258,322584548,526349743,177393696,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  149596791460,13211806540,1967593363,469561820,1036282691,294644972,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  155634157418,13428784216,1792558036,1058550374,949916078,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  147473256230,13195968700,2122839024,680760175,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  137369189941,12602721002,1365652100,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  135898351721,5739193823,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  119898443547,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
)

mpbs <- c(
  193603297695,11247634423,1059654319,744431215,222738609,202859460,85842949,281177807,146389189,150865609,162587546,21955762,55531415,210324385,25512204,45679764,17156972,6828595,2577485,57094615,13473401,12762984,47300,35912542,201448,126655,11973969,228746,3551220,0,0,238850,967659,570730,6825100,0,
  206891263553,12199344994,1984554362,562296113,337907831,189886026,275340980,414037978,145019256,78815714,46781495,248735303,86816062,161090328,20420766,41934137,10197439,45994857,22456173,14088441,85644863,5515044,21123557,32907970,5513167,810238,1504962,23648936,0,10461071,728,5978322,3705621,23766938,0,NA,
  204809075169,12146229890,1472902096,492576299,169330281,187484825,439030936,297744458,69112415,20215378,170330937,89957931,120326351,23780735,36819416,15402096,20731897,18327529,11418371,54714279,16383666,114823582,0,26197639,11721189,2476695,107612345,0,1514364,0,439660,192000,1022407,5356592,NA,NA,
  200659750060,11909714971,1747347150,769871714,404554140,327691000,113214573,162766791,27018780,115971878,67725117,249433781,39665777,20170546,1983441,9574761,4969319,15230328,26820121,11377925,57731219,7670341,51511707,3471144,8439608,5938194,0,2628516,8406939,2977507,616675,2227670,2988400,NA,NA,NA,
  203598127538,14322982846,1434769959,484783185,373764670,269212009,270985365,43906292,308065948,136242816,18336130,35368172,47178682,3797960,34702032,29120457,127591843,10011444,44512487,31040136,2392778,7678727,2386166,16770832,34176704,0,92750,0,2376694,5801649,0,1652145,NA,NA,NA,NA,
  212312603193,12386581429,1438461119,498251195,489463047,382277053,129820418,308610295,224206684,67539864,121800922,101349285,54977680,8351964,142895407,114214163,19765310,17442705,5494769,488852,1310150,0,2176944,623958,0,1140000,223000,4278556,346457,71000,4807967,NA,NA,NA,NA,NA,
  205543752622,12873646319,1488611680,772575653,489319449,93831399,325652120,153499483,135537938,87196142,75939630,16557308,19511732,31359727,17524346,2985276,14730204,22475414,623283,43263005,252406,2651027,2206565,8812817,2404053,3774401,12920871,2200532,4690255,2383733,NA,NA,NA,NA,NA,NA,
  207641628930,13068132057,1478548208,516238773,380476649,397292139,247246637,128560872,305831911,62167618,14651351,52395892,113025364,22018599,12545769,7645001,69385822,5486622,5919317,6271166,45685508,11860810,2059000,11611992,1372294,4575887,790806,666393,378178,NA,NA,NA,NA,NA,NA,NA,
  206467144099,13431294539,1298994182,639530525,924962410,237416290,234635568,444144064,191223940,351125099,79138114,32458291,38653254,7439780,33136674,1129512,18387416,3405497,1298739,12097335,4587838,0,1061192,0,879639,8032842,14825928,6298468,NA,NA,NA,NA,NA,NA,NA,NA,
  207958689844,13412148802,1777487206,1065481119,344512716,245950205,184168029,205957878,363405368,157787992,81172293,42635590,50642493,29296131,14583277,2021111,10464654,9818679,16863765,2370758,0,4650932,831780,6578733,23841004,28319500,18525673,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  204703419125,13232167165,2279187432,354186985,332827393,245467754,258124833,145929181,120095841,72420108,79195018,23639936,26694500,7884522,8097806,25366115,8505128,39194158,21396812,16755012,514300,356100,437378,20983821,10614929,3673450,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  221596662688,12648511836,1877581876,484111790,589291196,329309055,487370809,287279104,158968353,172186993,53974924,116500928,125198162,50061017,135346006,24484052,136996000,9181219,2977703,886508,801747,2102512,13313797,89841958,6505458,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  210182505166,13406539918,1514815047,664071983,378459651,547946707,462867942,87090343,214444024,102317057,64828904,109792170,86421240,27452716,38928300,94553353,11337223,13361750,2148361,2886201,50954264,10532930,18232951,80322302,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  219187120221,14067146170,2020999741,869973380,870180190,303415211,285129953,342405405,109975764,285548400,59936372,68369792,51819877,33668017,62015755,9229330,46406548,7441375,11144513,57029907,21733216,16678066,104515788,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  217549283032,12618414298,1866387938,871000989,803282323,507513216,623418407,104954074,301971584,64499780,78543209,45771874,26653202,38804109,2853540,63699379,2267525,6209406,63994345,16585776,287461841,46270848,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  222442653800,13422249945,1621717257,987362822,402154716,827760666,308317335,444005840,94802291,300301552,68132067,40440876,30408593,15594563,52885319,3660878,35431033,6786762,15559877,24649175,101489500,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  210906262247,13212808908,2190220265,807953764,861401331,461204686,621608107,94510119,256965074,211494605,60166355,172042098,6250507,22328649,2068215,82934494,14443269,51237678,9020555,70224763,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  211572330636,14023756235,1988527574,1194360803,616760473,394799928,84352578,171581932,76163874,69555903,126788232,40763202,83847611,7879509,31413421,15198760,147848547,66298198,42050851,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  217581019205,14653115105,2261029993,1014191063,512018128,423770800,262673474,75122229,58722213,152824770,44835311,40162665,19239980,25918378,40627458,260164394,48340690,82094425,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  214235766663,13631954013,2399686163,984746019,444482332,625091264,241762040,50354983,177591470,42470334,39688331,34283094,72299773,25143897,161841040,57342761,116382964,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  207696856379,13724682684,2362416435,911449699,529299032,347577697,119319748,165098139,66580875,55676342,34722852,135148352,51564152,166314827,65740257,48033879,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  204506280959,14973380387,1707720678,878971231,458321655,196823026,101007964,107031092,78123075,39912858,33525255,68694670,247628283,137615977,58693617,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  194564683930,13117628117,2035566593,589485823,292481557,104314340,118230598,87395576,277100551,34024715,140908683,318402511,341054990,185558232,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  214316383752,12662286872,2491292467,1226712799,414911554,291543453,293186421,251319548,33152880,148632065,909980374,588714430,217320381,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  221692878585,12167397770,1807769291,813698808,433054278,299182951,106460404,101241439,281678845,509182744,1058485784,466081367,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  222426525792,14436897095,1968859312,601629893,364258738,290030210,133000248,450996295,909430092,618998425,1278433919,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  228716753400,12772196178,1743606466,578429508,391896090,367564164,197305340,529996708,590982235,739098894,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  219569169840,14173093471,1916092044,944067843,587241481,226419886,510364529,974738214,802727838,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  195907702560,13546570956,1993755786,1100961011,366515065,650340982,1516400588,958555282,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  150127776322,13139483505,1946083083,599607071,1139063579,1379500999,1111150754,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  156492158021,13384428629,1787101172,1340826948,2101779723,1489026852,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  152747755438,13180494266,2623093788,2237375987,1765505902,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  149238065787,15526303100,3548720856,2035735359,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  146804626419,14119208876,3415201043,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  138678613538,18900502247,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
  112828509799,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA
)

options(max.print = 1000000)
nrowf=36

#install.packages('ChainLadder')
demo(package="ChainLadder")
library(ChainLadder)
#data(package="ChainLadder")
mpbs
my_triangle <- as.triangle(matrix(mpbs, nrow = nrowf, byrow = TRUE),origin = "NumAY", dev = "NumDY", value = "Paym")
my_triangle
my_triangle_cum <- incr2cum(my_triangle)
my_triangle_cum
plot(my_triangle_cum)
plot(my_triangle, lattice = TRUE)
plot(my_triangle_cum, lattice = TRUE)
getLatestCumulative(my_triangle_cum)
M<-0
#ejecuta MackChainLadder
M <- MackChainLadder(my_triangle_cum, est.sigma = "Mack")
M


M$f
plot(M$)
#ejecuta Bootstrap
B <- BootChainLadder(my_triangle_cum, R=999, process.distr="od.pois")
B
plot(B)
summary(B)$ByOrigin
quantile(B, c(0.75,0.95,0.99, 0.995))
summary(B)$Totals
